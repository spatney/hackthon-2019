<html>

<head>
    <style>
        #ip {
            margin: 10px;
            margin-left: 0;
        }

        .section {
            margin: 20px;
            margin-left: 0;
        }
    </style>
</head>

<body>
    <div id="ip">Getting IP address ...</div>
    <div class="section">
        <button onclick="action('Recycle')">Recycle</button>
        <button onclick="action('Trash')">Trash</button>
        <button onclick="action('Compost')">Compost</button>
    </div>
    <div class="section">
        <button onclick="demo()">Demo</button>
        <button onclick="identify()">Identify</button>
        <button onclick="camera()">Camera</button>
        <button onclick="flow()">Start Flow</button>
    </div>
    <div id="identity">Nothing identified yet</div>
    <div id="table"></div>
    <script src="soc.js"></script>
    <script src="client.js"></script>
    <script>
        let ref = new SocketClient({
            appId: 'bcabd300-42f3-462c-934e-e618033cabc6',
            uid: 'bin'
        });
        let i = 1;
        ref.subscribe(() => {
            console.log('subscribed');

            ref.on('ip_result', d => document.getElementById('ip').innerHTML = `Device is @ <b>${d.internal}</b>`);
            ref.on('identify_result', d => document.getElementById('identity').innerHTML = `I thought that was <b>${d.type}</b> What do you think?`);
            ref.emit('command', {
                device: 'ip'
            });

            ref.on('iot:error', e => {
                document.getElementById('ip').innerHTML = e.error
            });
        });

        function identify() {
            ref.emit('command', {
                device: 'identify'
            });
        }
        function demo() {
            ref.emit('command', {
                device: 'demo'
            });
        }
        function camera() {
            ref.emit('command', {
                device: 'camera'
            });
        }

        function flow() {
            document.getElementById('identity').innerHTML = `Identifying ... `
            ref.emit('command', {
                device: 'flow'
            });
        }

        function action(binId) {
            ref.emit('command', {
                device: 'classify',
                data: binId
            });
        }
    </script>
</body>

</html>